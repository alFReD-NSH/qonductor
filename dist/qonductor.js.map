{"version":3,"sources":["webpack:///webpack/bootstrap eab4463cc36eaa09b333","webpack:///./src/index.js","webpack:///./src/constants.js","webpack:///./src/defaults.js","webpack:///./src/QueueItem.js","webpack:///external {\"amd\":\"waddup\",\"commonjs\":\"waddup\",\"commonjs2\":\"waddup\",\"root\":\"waddup\"}","webpack:///./src/QueueError.js","webpack:///./src/utils.js"],"names":[],"mappings":"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","file":"qonductor.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap eab4463cc36eaa09b333\n **/","import {\n  statuses,\n  types\n} from './constants';\n\nimport {\n  getDefaults,\n  resetDefaults,\n  setDefaults\n} from './defaults';\n\nimport QueueItem from './QueueItem';\n\nimport {\n  isObject\n} from './utils';\n\nclass Qonductor {\n  constructor(options = {}) {\n    const {\n      autoStart: defaultAutoStart,\n      keepHistory: defaultKeepHistory,\n      maxConcurrency: defaultMaxConcurrency,\n      type: defaultType\n    } = getDefaults();\n\n    const {\n      autoStart = defaultAutoStart,\n      keepHistory = defaultKeepHistory,\n      maxConcurrency = defaultMaxConcurrency,\n      type = defaultType\n    } = options;\n\n    Object.assign(this, {\n      autoStart,\n      completed: {},\n      completedCount: 0,\n      currentIndex: 0,\n      keepHistory,\n      hasFinished: false,\n      hasStarted: false,\n      maxConcurrency,\n      pending: {},\n      pendingCount: 0,\n      queue: {},\n      running: {},\n      runningCount: 0,\n      type: type.toLowerCase()\n    });\n  }\n\n  /**\n   * add the cancel function to the queueItem\n   * \n   * @param {object} queueItem\n   * @return {function(message): void}\n   * @private\n   */\n  _addQueueItemCancel(queueItem) {\n    return (message) => {\n      queueItem._publishCancellation(message);\n    };\n  }\n\n  /**\n   * remove the queueItem from the running / pending list and\n   * move to completed\n   * \n   * @param {number} index\n   * @param {object} queueItem\n   * @private\n   */\n  _complete(index, queueItem) {\n    if (!this.completed[index]) {\n      if (this.keepHistory) {\n        this.completed[index] = queueItem;\n      }\n\n      this.completedCount++;\n    }\n\n    if (this.running[index]) {\n      delete this.running[index];\n      this.runningCount--;\n    } else if (this.pending[index]) {\n      delete this.pending[index];\n      this.pendingCount--;\n    }\n\n    delete this.queue[index];\n\n    if (this.hasStarted && this.pendingCount) {\n      this.start();\n    } else if (!this.runningCount && !this.pendingCount) {\n      this.hasFinished = true;\n    }\n  }\n\n  /**\n   * based on the type, return the next index to process\n   * \n   * @param {array<string>} keys\n   * @param {string} type\n   * @return {string}\n   * @private\n   */\n  _getNextIndex(keys, type) {\n    if (!keys.length) {\n      return -1;\n    }\n\n    switch (type) {\n      case types.LIFO:\n        return Math.max.apply(this, keys);\n      \n      case types.SIRO:\n        return keys[Math.floor(Math.random() * keys.length)];\n\n      default:\n        return Math.min.apply(this, keys);\n    }\n  }\n\n  /**\n   * add the function to the queue\n   * \n   * @param {function} fn\n   * @return {Promise}\n   */\n  add(fn) {\n    const index = this.currentIndex;\n    const queueItem = new QueueItem(index, fn, this._complete.bind(this));\n\n    this.queue[index] = queueItem;\n\n    this.currentIndex++;\n\n    this.pending[index] = queueItem;\n    this.pendingCount++;\n\n    queueItem.promise.cancel = this._addQueueItemCancel(queueItem);\n\n    if (this.autoStart && this.runningCount < this.maxConcurrency) {\n      this.start();\n    }\n\n    return queueItem.promise;\n  }\n\n  /**\n   * cancel all remaining promises in the queue\n   */\n  clear() {\n    Object.keys(this.queue).forEach((key) => {\n      if (this.queue[key].status !== statuses.COMPLETED) {\n        this.queue[key].promise.cancel();\n      }\n    });\n  }\n\n  /**\n   * get the global defaults for Qonductor\n   *\n   * @returns {object}\n   */\n  static getDefaults() {\n    return getDefaults();\n  }\n\n  /**\n   * reset the global defaults for Qonductor\n   *\n   * @returns {object}\n   */\n  static resetDefaults() {\n    return resetDefaults();\n  }\n\n  /**\n   * set the global defaults for Qonductor\n   *\n   * @param {object} newDefaults={}\n   * @returns {object}\n   */\n  static setDefaults(newDefaults = {}) {\n    if (!isObject(newDefaults)) {\n      throw new SyntaxError('Defaults assignment must be passed an object.');\n    }\n    \n    return setDefaults(newDefaults);\n  }\n\n  /**\n   * kick off the processing of the queue\n   */\n  start() {\n    this.hasStarted = true;\n    this.hasFinished = false;\n\n    let running = this.runningCount;\n\n    while (++running <= this.maxConcurrency) {\n      const index = this._getNextIndex(Object.keys(this.pending), this.type);\n\n      if (index === -1) {\n        break;\n      }\n\n      const queueItem = this.pending[index];\n\n      this.running[index] = queueItem;\n      this.runningCount++;\n\n      delete this.pending[index];\n      this.pendingCount--;\n\n      queueItem.run();\n    }\n  }\n}\n\nexport default Qonductor;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","const STATUSES = {\n  CANCELLED: 'CANCELLED',\n  COMPLETED: 'COMPLETED',\n  FAILED: 'FAILED',\n  PENDING: 'PENDING',\n  RUNNING: 'RUNNING'\n};\n\nconst TYPES = {\n  FIFO: 'fifo',\n  LIFO: 'lifo',\n  SIRO: 'siro'\n};\n\nexport {STATUSES as statuses};\nexport {TYPES as types};\n\nexport default {\n  statuses: STATUSES,\n  types: TYPES\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/constants.js\n **/","const DEFAULTS = {\n  autoStart: true,\n  keepHistory: true,\n  maxConcurrency: 10,\n  type: 'fifo'\n};\n\nlet currentDefaults = {\n  ...DEFAULTS\n};\n\n/**\n * get the current defaults\n *\n * @return {{autoStart: boolean, keepHistory: boolean, maxConcurrency: number, type: string}}\n */\nconst getDefaults = () => {\n  return currentDefaults;\n};\n\n/**\n * reset the defaults to their original setting\n * \n * @return {object}\n */\nconst resetDefaults = () => {\n  currentDefaults = {\n    ...DEFAULTS\n  };\n  \n  return currentDefaults;\n};\n\n/**\n * assign the keys in newDefaults to those in defaults if they exist in defaults\n *\n * @param {object} newDefaults={}\n * @return {{autoStart: boolean, keepHistory: boolean, maxConcurrency: number, type: string}}\n */\nconst setDefaults = (newDefaults = {}) => {\n  Object.keys(newDefaults).forEach((key) => {\n    if (currentDefaults.hasOwnProperty(key)) {\n      currentDefaults[key] = newDefaults[key];\n    }\n  });\n  \n  return currentDefaults;\n};\n\nexport {getDefaults};\nexport {resetDefaults};\nexport {setDefaults};\n\nexport default {\n  getDefaults,\n  resetDefaults,\n  setDefaults\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/defaults.js\n **/","import {\n  publish,\n  subscribe,\n  unsubscribe\n} from 'waddup';\n\nimport {\n  statuses\n} from './constants';\n\nimport QueueError from './QueueError';\n\nimport {\n  isFunction\n} from './utils';\n\n/**\n * get the done function with assigned success / fail actions based\n * on parameters passed to it\n * \n * @param {function} success\n * @param {function} fail\n * @return {function(data: string, error: QueueError): void}\n */\nconst getDone = (success, fail) => {\n  return (data, error) => {\n    if (error) {\n      fail(error);\n    } else {\n      success(data);\n    }\n  };\n};\n\n/**\n * on fail, run the completion function and return a\n * rejected Promise to trigger the next catch\n *\n * @param {QueueItem} queueItem\n * @param {function} onComplete\n * @return {function(error: Error): Promise}\n */\nconst getOnFail = (queueItem, onComplete) => {\n  return (error) => {\n    onComplete(queueItem.id, queueItem);\n\n    return Promise.reject(error);\n  };\n};\n\n/**\n * on success, run the completion function and return the data\n * to trigger the next then\n *\n * @param {QueueItem} queueItem\n * @param {function} onComplete\n * @return {function(data: any): any}\n */\nconst getOnSuccess = (queueItem, onComplete) => {\n  return (data) => {\n    onComplete(queueItem.id, queueItem);\n\n    return data;\n  };\n};\n\nclass QueueItem {\n  constructor(id, fn, onComplete) {\n    Object.assign(this, {\n      cancelId: null,\n      id,\n      isCancelled: false,\n      promiseId: null,\n      status: statuses.PENDING\n    });\n\n    const onFail = getOnFail(this, onComplete);\n    const onSuccess = getOnSuccess(this, onComplete);\n\n    this.promise = this._createPromiseWrapper(fn, onSuccess, onFail);\n  }\n\n  /**\n   * create the promise wrapper for the function passed\n   *\n   * @param {function} fn\n   * @param {function} onSuccess\n   * @param {function} onFail\n   * @return {Promise}\n   * @private\n   */\n  _createPromiseWrapper(fn, onSuccess, onFail) {\n    const queuedFunction = isFunction(fn) ? fn : (done) => {\n      return done(fn);\n    };\n    const unsubscribeOnSuccess = this._getUnsubscribeOnResolve();\n    const unsubscribeOnFail = this._getUnsubscribeOnReject();\n\n    return new Promise((resolve, reject) => {\n      const success = this._resolvePromise(resolve);\n      const fail = this._rejectPromise(reject);\n      const done = getDone(success, fail);\n\n      this.cancelId = subscribe(statuses.CANCELLED, (topic, {id, message}) => {\n        if (id === this.id) {\n          this.isCancelled = true;\n\n          this._cancelPromise(reject, message);\n        }\n      });\n\n      this.promiseId = subscribe(statuses.RUNNING, (topic, id) => {\n        if (id === this.id) {\n          queuedFunction(done);\n\n          unsubscribe(this.promiseId);\n        }\n      });\n    })\n      .then(unsubscribeOnSuccess)\n      .catch(unsubscribeOnFail)\n      .then(onSuccess)\n      .catch(onFail);\n  }\n\n  /**\n   * cancel the existing promise, rejecting it with the message provided\n   *\n   * @param {function} reject\n   * @param {string} message\n   * @private\n   */\n  _cancelPromise(reject, message) {\n    this.status = statuses.CANCELLED;\n\n    reject(new QueueError(message, statuses.CANCELLED));\n  }\n\n  /**\n   * publish the cancellation\n   *\n   * @param {string} message\n   * @private\n   */\n  _publishCancellation(message) {\n    publish(statuses.CANCELLED, {\n      id: this.id,\n      message\n    });\n  }\n\n  /**\n   * reject the promise with the error provided\n   *\n   * @param {function} reject\n   * @return {function(error: Error): void}\n   * @private\n   */\n  _rejectPromise(reject) {\n    return (error) => {\n      if (!this.isCancelled) {\n        this.status = statuses.FAILED;\n\n        reject(new QueueError(error));\n      }\n    };\n  }\n\n  /**\n   * resolve the promise with the data provided\n   *\n   * @param {function} resolve\n   * @return {function(data: any): void}\n   * @private\n   */\n  _resolvePromise(resolve) {\n    return (data) => {\n      if (!this.isCancelled) {\n        this.status = statuses.COMPLETED;\n\n        resolve(data);\n      }\n    };\n  }\n\n  /**\n   * unsubscribe the cancellation once the promise is rejected\n   *\n   * @return {function(error: Error): Promise}\n   * @private\n   */\n  _getUnsubscribeOnReject() {\n    return (error) => {\n      unsubscribe(this.cancelId);\n\n      return Promise.reject(error);\n    };\n  }\n\n  /**\n   * unsubscribe the cancellation once the promise is resolved\n   *\n   * @return {function(data: any): Promise}\n   * @private\n   */\n  _getUnsubscribeOnResolve() {\n    return (data) => {\n      unsubscribe(this.cancelId);\n\n      return data;\n    };\n  }\n\n  /**\n   * publjsh that this queueItem is running\n   */\n  run() {\n    this.status = statuses.RUNNING;\n\n    publish(statuses.RUNNING, this.id);\n  }\n}\n\nexport default QueueItem;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/QueueItem.js\n **/","module.exports = undefined;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"amd\":\"waddup\",\"commonjs\":\"waddup\",\"commonjs2\":\"waddup\",\"root\":\"waddup\"}\n ** module id = 5\n ** module chunks = 0\n **/","import {\n  statuses\n} from './constants';\n\nclass CustomError extends Error {\n  constructor(message) {\n    super();\n\n    if (Error.hasOwnProperty('captureStackTrace')) {\n      Error.captureStackTrace(this, this.constructor);\n    } else {\n      \n      Object.defineProperty(this, 'stack', {\n        value: (new Error()).stack\n      });\n    }\n\n    Object.defineProperty(this, 'message', {\n      value: message\n    });\n  }\n}\n\nclass QueueError extends CustomError {\n  constructor(message = '', type = statuses.FAILED) {\n    super(`Queue promise was rejected with status ${type}${message ? ': ' : '.'}${message}`);\n  }\n}\n\nexport default QueueError;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/QueueError.js\n **/","const toString = (object) => {\n  return Object.prototype.toString.call(object);\n};\n\n/**\n * determine whether object is a function\n *\n * @param {any} object\n * @return {boolean}\n */\nconst isFunction = (object) => {\n  return toString(object) === '[object Function]' || typeof object === 'function';\n};\n\n/**\n * determine whether object is an object\n *\n * @param {any} object\n * @return {boolean}\n */\nconst isObject = (object) => {\n  return toString(object) === '[object Object]' && !!object;\n};\n\nexport {isFunction};\nexport {isObject};\n\nexport default {\n  isFunction,\n  isObject\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/utils.js\n **/"],"sourceRoot":""}